nameOverride: porkbun
fullnameOverride: porkbun

image:
  repository: larenso/porkbun_crtmngr
  tag: latest

args:
- --tls-cert-file=/tls/tls.crt
- --tls-private-key-file=/tls/tls.key

env:
- name: GROUP_NAME
  value: "porkbun"
- name: NAMESPACE
  valueFrom:
    fieldRef:
      fieldPath: metadata.namespace
- name: PB_API
  valueFrom:
    secretKeyRef:
      name: porkbun-key
      key: api-key
- name: PB_SECRET
  valueFrom:
    secretKeyRef:
      name: porkbun-key
      key: secret-key
- name: DOMAINS
  value: "ha.ebapeka.top,im.ebapeka.top"
- name: RUN_JOB
  value: "true"

service:
  ports:
  - port: 443
    name: https
    appProtocol: https

livenessProbe:
  httpGet:
    scheme: HTTPS
    path: /healthz
    port: 443
readinessProbe:
  httpGet:
    scheme: HTTPS
    path: /healthz
    port: 443

volumeMounts:
- name: certs
  mountPath: /tls
  readOnly: true

volumes:
- name: certs
  secret:
    secretName: porkbun-tls

resources:
  limits:
    memory: 32Mi
  requests:
    cpu: 20m
    memory: 32Mi

affinity:
  nodeAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
        nodeSelectorTerms:
        - matchExpressions:
          - key: node.io/role
            operator: In
            values:
            - core

serviceAccount:
  create: true
  automount: true

podSecurityContext:
  runAsUser: 50001
  runAsGroup: 50001
  fsGroup: 50001

certmanager:
  groupName: "porkbun"
  serviceAccountName: cert-manager
  namespace: cert-manager
  issuer: cluster-private
